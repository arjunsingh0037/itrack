define(function(){function a(){this.greekLetterNames=["Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"]}return a.prototype.convertLatexShortcuts=function(a){for(var b=0;b<this.greekLetterNames.length;b++){var c=this.greekLetterNames[b];a=a.replace(new RegExp("\\\\"+c,"g"),String.fromCharCode(913+b+(b>16))),a=a.replace(new RegExp("\\\\"+c.toLowerCase(),"g"),String.fromCharCode(945+b+(b>16)))}for(var b=0;b<10;b++)a=a.replace(new RegExp("_"+b,"g"),String.fromCharCode(8320+b));return a=a.replace(new RegExp("_a","g"),String.fromCharCode(8336))},a.prototype.drawArrow=function(a,b,c,d){var e=Math.cos(d),f=Math.sin(d);a.beginPath(),a.moveTo(b,c),a.lineTo(b-8*e+5*f,c-8*f-5*e),a.lineTo(b-8*e-5*f,c-8*f+5*e),a.fill()},a.prototype.det=function(a,b,c,d,e,f,g,h,i){return a*e*i+b*f*g+c*d*h-a*f*h-b*d*i-c*e*g},a.prototype.circleFromThreePoints=function(a,b,c,d,e,f){var g=this.det(a,b,1,c,d,1,e,f,1),h=-this.det(a*a+b*b,b,1,c*c+d*d,d,1,e*e+f*f,f,1),i=this.det(a*a+b*b,a,1,c*c+d*d,c,1,e*e+f*f,e,1),j=-this.det(a*a+b*b,a,b,c*c+d*d,c,d,e*e+f*f,e,f);return{x:-h/(2*g),y:-i/(2*g),radius:Math.sqrt(h*h+i*i-4*g*j)/(2*Math.abs(g))}},a.prototype.isInside=function(a,b){return a.x>b.x&&a.x<b.x+b.width&&a.y<b.y+b.height&&a.y>b.y},a.prototype.crossBrowserKey=function(a){return a=a||window.event,a.which||a.keyCode},a.prototype.crossBrowserElementPos=function(a){a=a||window.event;for(var b=a.target||a.srcElement,c=0,d=0;b.offsetParent;)c+=b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;return{x:c,y:d}},a.prototype.crossBrowserMousePos=function(a){return a=a||window.event,{x:a.pageX||a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.pageY||a.clientY+document.body.scrollTop+document.documentElement.scrollTop}},a.prototype.crossBrowserRelativeMousePos=function(a){var b=this.crossBrowserElementPos(a),c=this.crossBrowserMousePos(a);return{x:c.x-b.x,y:c.y-b.y}},new a});